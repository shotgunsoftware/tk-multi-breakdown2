

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Breakdown Hooks &mdash; tk-multi-breakdown2 v0.2.10 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Toolkit Engine Notes" href="engine-specific-notes.html" />
    <link rel="prev" title="Breakdown API" href="api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    <a href='https://help.autodesk.com/view/SGDEV/ENU/'>
    
        <img style='width: 191px;
                height: 60px;
                margin: 2px;
                border-radius: 0px;
                padding: 0px;'
            src='_static/logo@2x.png'/>
    
    </a>
    

          
          
          <a href="index.html" class="icon icon-home">
            tk-multi-breakdown2
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">Breakdown API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Breakdown Hooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hook-scene-operations">hook_scene_operations:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hook-get-published-files">hook_get_published_files:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hook-ui-config">hook_ui_config:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-examples">Basic Examples:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shotgrid-token-resolution-and-formatting">ShotGrid Token Resolution and Formatting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hook-ui-config-advanced">hook_ui_config_advanced:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#class-attributes">Class Attributes:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#class-methods">Class Methods:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-methods">Static Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Basic Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="engine-specific-notes.html">Toolkit Engine Notes</a></li>
</ul>


    <a href='genindex.html'>Alphabetic Index</a>

    <div style='margin-top: 50px;
                margin-left: 10px;
                margin-right: 10px;
                padding: 10px;
                color: #b3b3b3;
                font-size: 70%;
                border-radius: 3px;
                background-color: #444;
                line-height: 18px;
                '>
    <style>
        a.custom_post_menu { display: inline;
                             padding: 0px;
                             text-decoration: underline; }
    </style>

    <b>tk-multi-breakdown2</b> v0.2.10.<br>
    
        This documentation is part of the Flow Production Tracking.
    
    For more information, please visit
    <a class=custom_post_menu href='https://help.autodesk.com/view/SGDEV/ENU/'>The Flow Production Tracking developer portal.</a>.
    The code associated with this documentation can be found
    <a class=custom_post_menu href='https://github.com/shotgunsoftware/tk-multi-breakdown2'>here</a>.

    </div>
    <style>
        p.privacy_links { margin: 4px 0px;}
    </style>
    <p class="privacy_links"><a data-opt-in-preferences href="javascript:;">Privacy settings</a></p>
    <p class="privacy_links"><a data-wat-linkname="manage-ccpa-settings-footer-link" href="javascript:;">Do not sell my personal information</a></p>
    <p class="privacy_links"><a href="https://www.autodesk.com/company/legal-notices-trademarks/privacy-statement">Privacy/Cookies</a></p>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tk-multi-breakdown2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Breakdown Hooks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="breakdown-hooks">
<span id="id1"></span><h1>Breakdown Hooks<a class="headerlink" href="#breakdown-hooks" title="Permalink to this heading"></a></h1>
<section id="hook-scene-operations">
<h2>hook_scene_operations:<a class="headerlink" href="#hook-scene-operations" title="Permalink to this heading"></a></h2>
<p>An engine specific hook that handles detecting references in the scene.</p>
</section>
<section id="hook-get-published-files">
<h2>hook_get_published_files:<a class="headerlink" href="#hook-get-published-files" title="Permalink to this heading"></a></h2>
<p>A hook to define how Published Files are queried; e.g. specifiy filters, fields, order, etc. when retrieving Published Files, which are displayed in the file view.</p>
</section>
<section id="hook-ui-config">
<h2>hook_ui_config:<a class="headerlink" href="#hook-ui-config" title="Permalink to this heading"></a></h2>
<p>A simple hook to customize the display of the view and details widget. When the application displays the items in the main file view, the right-hand panel details widget and history view, it will call this hook to determine which data to display for that particular widget and how it should be formatted.</p>
<p><strong>Methods:</strong></p>
<dl class="simple">
<dt>file_item_details</dt><dd><ul class="simple">
<li><p>Set the data shown in the file list items, and define how that data is formatted</p></li>
</ul>
</dd>
<dt>main_file_history_details</dt><dd><ul class="simple">
<li><p>Set the data shown in right-hand side panel widget, and define how that data is formatted</p></li>
</ul>
</dd>
<dt>file_history_details</dt><dd><ul class="simple">
<li><p>Set the data shown in the right-hand side panel, file history list items, and define how that data is formattted</p></li>
</ul>
</dd>
</dl>
<section id="basic-examples">
<h3>Basic Examples:<a class="headerlink" href="#basic-examples" title="Permalink to this heading"></a></h3>
<p>Each of the hook methods will return the formatted data in the form of a templated string, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="n">By</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">b</span><span class="o">&gt;</span> <span class="p">{</span><span class="n">created_by</span><span class="p">}{[</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="n">Description</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">b</span><span class="o">&gt;</span> <span class="p">]</span><span class="n">description</span><span class="p">}</span>
</pre></div>
</div>
<p>What this templated string does:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Uses HTML tags to make the text, <em>“By:”</em>, bolded</p></li>
<li><p>Uses ShotGrid token resolution to display and format the entity’s description field</p></li>
</ol>
</div></blockquote>
</section>
<section id="shotgrid-token-resolution-and-formatting">
<span id="sg-token-res"></span><h3>ShotGrid Token Resolution and Formatting<a class="headerlink" href="#shotgrid-token-resolution-and-formatting" title="Permalink to this heading"></a></h3>
<p>The ShotGrid token resolution will convert the values defined like, <code class="docutils literal notranslate"><span class="pre">{token}</span></code>, into formatted strings using ShotGrid data. These token values can be defined using the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{[</span><span class="n">preroll</span><span class="p">]</span><span class="n">shotgun</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="o">|</span><span class="n">sg_field_name_fallback</span><span class="p">::</span><span class="n">directive</span><span class="p">[</span><span class="n">postroll</span><span class="p">]}</span>
</pre></div>
</div>
<p><strong>Formatting Options:</strong></p>
<blockquote>
<div><dl class="simple">
<dt>Simple format: {field}</dt><dd><ul class="simple">
<li><p>Example, <code class="docutils literal notranslate"><span class="pre">{code}</span></code> will be substituted with the entity’s code value</p></li>
</ul>
</dd>
<dt>Deep links: {field1.field1_type.field_of_field1}</dt><dd><ul class="simple">
<li><p>Example, <code class="docutils literal notranslate"><span class="pre">{sg_sequence.Sequence.code}</span></code> will be substituted with the entity’s Sequence code value</p></li>
</ul>
</dd>
<dt>Fallback options: {field | field2}</dt><dd><ul class="simple">
<li><p>Example, <code class="docutils literal notranslate"><span class="pre">{artist|created_by}</span></code> will be substituted with the entity’s artist, if it does not exist, then it will substitute with the created by user</p></li>
</ul>
</dd>
<dt>Directives: {…::directive1::directive2}</dt><dd><ul class="simple">
<li><p>Directives can be chained to apply multiple directives</p></li>
<li><p>Example, <code class="docutils literal notranslate"><span class="pre">{sg_sequence::showtype}</span></code> - This will generate a link saying ‘Sequence ABC123’ instead of the default, ‘ABC123’</p></li>
<li><p>Example, <code class="docutils literal notranslate"><span class="pre">{sg_sequence::nolink}</span></code> - No url link will be created or shown</p></li>
</ul>
</dd>
<dt>Pre/Post Rolls: {[pre_roll]…[post_roll]}</dt><dd><ul class="simple">
<li><p>If a value is null, pre- and post-strings are omitted from the final result.</p></li>
<li><p>Pre roll example, <code class="docutils literal notranslate"><span class="pre">{[Name:</span> <span class="pre">]code}</span></code> - If code is set, ‘Name: xxx’ will be printed out, otherwise nothing.</p></li>
<li><p>Pre and Post roll example, <code class="docutils literal notranslate"><span class="pre">{[Name:</span> <span class="pre">]code[&lt;br&gt;]}</span></code> - Same as above but with a post line break</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="hook-ui-config-advanced">
<h2>hook_ui_config_advanced:<a class="headerlink" href="#hook-ui-config-advanced" title="Permalink to this heading"></a></h2>
<p>This is an advanced hook to customize the UI. For a simplified approach, see the hook_ui_config.</p>
<p>When using this hook, it is beneficial to have an understanding of Object Oriented Programming (e.g. class inheritance) and how Qt Models work (e.g. including the use of proxy models). You may also need to reference the Breakdown2 classes, such as the FileModel, FileProxyModel and FileHistoryModel, as well as the tk-framework-qtwidgets utils module and ViewItemDelegate class.</p>
<p>The default hook implementation will call the hook_ui_config under the hood, to retrieve the data and formatting that should be displayed. Then, any further processing of the data can be applied in this hook. The template strings returned from the hook_ui_config, are stored as class attributes in this hook, so that each hook method to access.</p>
<section id="class-attributes">
<h3>Class Attributes:<a class="headerlink" href="#class-attributes" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>_title_template_string</dt><dd><ul class="simple">
<li><p>This is the <cite>“top-left”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_item_details</cite></p></li>
</ul>
</dd>
<dt>_subtitle_template_string</dt><dd><ul class="simple">
<li><p>This is the <cite>“top-right”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_item_details</cite></p></li>
</ul>
</dd>
<dt>_details_template_string</dt><dd><ul class="simple">
<li><p>This is the <cite>“body”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_item_details</cite></p></li>
</ul>
</dd>
<dt>_short_text_template_string</dt><dd><ul class="simple">
<li><p>This is the <cite>“thumbnail-body”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_item_details</cite></p></li>
</ul>
</dd>
<dt>_show_thumbnail</dt><dd><ul class="simple">
<li><p>This is the <cite>“thumbnail”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_item_details</cite></p></li>
</ul>
</dd>
<dt>_history_title_template_string</dt><dd><ul class="simple">
<li><p>This is the <cite>“top-left”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_history_details</cite></p></li>
</ul>
</dd>
<dt>_history_subtitle_template_string</dt><dd><ul class="simple">
<li><p>This is the <cite>“top-right”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_history_details</cite></p></li>
</ul>
</dd>
<dt>_history_details_template_string</dt><dd><ul class="simple">
<li><p>This is the <cite>“body”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_history_details</cite></p></li>
</ul>
</dd>
<dt>_history_show_thumbnail</dt><dd><ul class="simple">
<li><p>This is the <cite>“thumbnail”</cite> value of the dictionary returned by the hook_ui_config method <cite>file_history_details</cite></p></li>
</ul>
</dd>
</dl>
<p>The methods in this hook are called from the FileModel and FileHistoryModel classes to retrieve the data to pass to their respective view’s delegate, which controls how each view item is rendered. The FileModel stores the data displayed in the main file view. The FileHistoryModel stores the data displayed in the file details panel; e.g. when a file is selected, the file details that are shown for that selected item.</p>
</section>
<section id="class-methods">
<h3>Class Methods:<a class="headerlink" href="#class-methods" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>get_item_title</dt><dd><ul class="simple">
<li><p>The return value will decide the text displayed in the item’s top left text area.</p></li>
</ul>
</dd>
<dt>get_item_subtitle</dt><dd><ul class="simple">
<li><p>The return value will decide the text displayed in the item’s top right text area.</p></li>
</ul>
</dd>
<dt>get_item_details</dt><dd><ul class="simple">
<li><p>The return value will decide the item’s main text body.</p></li>
</ul>
</dd>
<dt>get_item_short_text</dt><dd><ul class="simple">
<li><p>The return value will decide the text displayed for the item’s condensed text. This value is used for the Thumbnail view.</p></li>
</ul>
</dd>
<dt>get_item_thumbnail</dt><dd><ul class="simple">
<li><p>The return value will decide the image displayed for the item.</p></li>
</ul>
</dd>
<dt>get_item_icons</dt><dd><ul class="simple">
<li><p>The return value will decide if any icons are displayed over the thumbnail; e.g: status icons.</p></li>
</ul>
</dd>
<dt>get_item_separator</dt><dd><ul class="simple">
<li><p>The return value will decide if a separator line wil lbe drawn for the item.</p></li>
</ul>
</dd>
<dt>get_history_item_title</dt><dd><ul class="simple">
<li><p>Similar to the <cite>get_item_title</cite> method, but this acts on the file history view.</p></li>
<li><p>The return value will decide the text displayed in the history item’s top left text area.</p></li>
</ul>
</dd>
<dt>get_history_item_subtitle</dt><dd><ul class="simple">
<li><p>Similar to the <cite>get_item_subtitle</cite> method, but this acts on the file history view.</p></li>
<li><p>The return value will decide the text displayed in the history item’s top right text area.</p></li>
</ul>
</dd>
<dt>get_history_item_details</dt><dd><ul class="simple">
<li><p>Similar to the <cite>get_item_details</cite> method, but this acts on the file history view.</p></li>
<li><p>The return value will decide the history item’s main text body.</p></li>
</ul>
</dd>
<dt>get_history_item_thumbnail</dt><dd><ul class="simple">
<li><p>Similar to the <cite>get_item_thumbnail</cite> method, but this acts on the file history view.</p></li>
<li><p>The return value will decide the image displayed for the item.</p></li>
</ul>
</dd>
<dt>get_history_item_icons</dt><dd><ul class="simple">
<li><p>Similar to the <cite>get_item_icons</cite> method, but this acts on the file history view.</p></li>
<li><p>The return value will decide if any icons are displayed over the thumbnail; e.g: status icons.</p></li>
</ul>
</dd>
<dt>get_history_item_separator</dt><dd><ul class="simple">
<li><p>Similar to the <cite>get_item_separator</cite> method, but this acts on the file history view.</p></li>
<li><p>The return value will decide if a separator line wil lbe drawn for the item.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="static-methods">
<h3>Static Methods<a class="headerlink" href="#static-methods" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>get_file_item(index)</dt><dd><ul class="simple">
<li><p>This is a helper method to extract the <code class="docutils literal notranslate"><span class="pre">FileItem</span></code> data from the given index. The <cite>FileItem</cite> object will hold the ShotGrid data associated with this index, that can be displayed in the view.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id2">
<h3>Basic Examples<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>This example demonstrates how to get the index data from a model role, to display for the file item’s title field. The <code class="docutils literal notranslate"><span class="pre">DisplayRole</span></code> data will be retrieved for each index and shown in the top-left of the file item text.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_item_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">)</span>
</pre></div>
</div>
<p>We can extend this example to use the hook’s static method <code class="docutils literal notranslate"><span class="pre">get_file_item</span></code>, to get the ShotGrid data for this index to display certain ShotGrid data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_item_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">file_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_item</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file_item</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">file_item</span><span class="o">.</span><span class="n">sg_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created_by&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">)</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">FileItem</span></code> object is retrieved for this index, display the user who created this ShotGrid entity that the item is associated with. Notice that if a FileItem object was not found, we default to display the indexes DisplayRole data.</p>
<p>We can take this example one step further by using the hook attribute <code class="docutils literal notranslate"><span class="pre">_title_template_string</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_item_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">file_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_item</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file_item</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title_template_string</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_title_template_string</span><span class="p">,</span> <span class="n">file_item</span><span class="o">.</span><span class="n">sg_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">file_item</span><span class="o">.</span><span class="n">sg_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created_by&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we are returning a tuple containing the template string defined in the simple hook_ui_config and the FileItem object’s ShotGrid data dictionary. The returned tuple will then be passed to the <code class="docutils literal notranslate"><span class="pre">ViewItemDelegate</span></code> class, which will process the template string with the provided ShotGrid data and replace any <code class="docutils literal notranslate"><span class="pre">{token}</span></code> values in the template string with the ShotGrid data. See <a class="reference internal" href="#sg-token-res"><span class="std std-ref">ShotGrid Token Resolution and Formatting</span></a> for more details.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api.html" class="btn btn-neutral float-left" title="Breakdown API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="engine-specific-notes.html" class="btn btn-neutral float-right" title="Toolkit Engine Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Autodesk.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

  <script type="text/javascript">
    window.wafCCPAForceShow = true;
    (function(a,b,c,d){
      a='https://tags.tiqcdn.com/utag/autodesk/micro-basic/prod/utag.js';
      b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
      a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
  </script>


</body>
</html>